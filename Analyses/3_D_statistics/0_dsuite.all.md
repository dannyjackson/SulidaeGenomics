# Dsuite all
Set working directory
```
cd /xdisk/mcnew/dannyjackson/sulidae/analyses/dsuite/all_likelihoods
```
Save this as SETS.txt:
```
BFBO501 BFBO_southern
BFBO502 BFBO_southern
BFBO503 BFBO_southern
BFBO504 BFBO_GofCA
BFBO505 BFBO_southern
BRBO201 BRBO_Pacific
BRBO202 BRBO_Pacific
BRBO203 BRBO_AtlCar
BRBO205 BRBO_AtlCar
MABO302 MABO_IndoPacific
MABO304 MABO_AtlCar
MABO305 MABO_AtlCar
MABO306 MABO_IndoPacific
NABO402 NABO
NABO403 NABO
NABO404 NABO
NABO405 NABO
NABO406 NABO
PEBO601 PEBO
PEBO603 PEBO
PEBO604 PEBO
PEBO605 PEBO
PEBO606 PEBO
RFBO101 Outgroup
RFBO102 Outgroup
RFBO103 Outgroup
RFBO104 Outgroup
RFBO105 Outgroup
RFBO106 Outgroup
```
Filter vcf to just autosomes and then run dsuite on the entire genome
```
sbatch 0a_dsuite_autosomes.sh
```
Correct for false discovery rate using the p-values from the f_branch p-value statistic:
```
R
# likelihood f_branch 
pvalues <- c(1,1,1,0.611558542,1,0,0,1,1,0,1,1,1,0.000852933,1,0,5.08482E-14,1,1,0,0,1,1,0,0,1,1,0,0,1,1,4.55858E-13,0,1,1,0,0,1,1,0,1,0,0,1,1,0,1,0,0,1,1,5.60889E-09,0,1,0,1,1,0.005135488,0,1)
p.adjust(pvalues, method = "fdr")
```
This output the following list:
```
1.000000e+00
1.000000e+00
1.000000e+00
1.000000e+00
1.000000e+00
0.000000e+00
0.000000e+00
1.000000e+00
1.000000e+00
0.000000e+00
1.000000e+00
1.000000e+00
1.000000e+00
1.968307e-03
1.000000e+00
0.000000e+00
1.326475e-13
1.000000e+00
1.000000e+00
0.000000e+00
0.000000e+00
1.000000e+00
1.000000e+00
0.000000e+00
0.000000e+00
1.000000e+00
1.000000e+00
0.000000e+00
0.000000e+00
1.000000e+00
1.000000e+00
1.139645e-12
0.000000e+00
1.000000e+00
1.000000e+00
0.000000e+00
0.000000e+00
1.000000e+00
1.000000e+00
0.000000e+00
1.000000e+00
0.000000e+00
0.000000e+00
1.000000e+00
1.000000e+00
0.000000e+00
1.000000e+00
0.000000e+00
0.000000e+00
1.000000e+00
1.000000e+00
1.346134e-08
0.000000e+00
1.000000e+00
0.000000e+00
1.000000e+00
1.000000e+00
1.141220e-02
0.000000e+00
1.000000e+00
```
# p value
pvalues <- c(5.78E-07,1.11E-09,4.67E-10,5.03E-14,0.0587784,2.30E-16,2.30E-16,0.0190071,0.964665,2.75E-14,0.45049,2.86E-09,0.000185578,1.06E-08,0.0861671,3.21E-05,2.83E-08,0.0462343,4.89E-15,0.134311,0.00562289,2.30E-16,2.08E-13,1.62E-05,2.30E-16,2.30E-16,0.914922,0.011247,0.454719,6.52E-15,5.91E-06,2.30E-16,2.30E-16,2.30E-16,2.30E-16,0.249513,2.30E-16,2.30E-16,2.30E-16,2.30E-16,6.73E-08,6.93E-15,0.0402984,2.30E-16,0.540441,2.30E-16,1.08E-10,0.129367,2.48E-09,3.99E-08,0.00171307,2.09E-09,2.30E-16,5.69E-07,2.50E-08,2.30E-16)
# clustering sensitive
pvalues <- c(0.0168534,0.181557,0.00308481,0.0114666,0.0044783,7.03E-06,0.000670175,0.0267089,0.00336978,0.128823,0.0174879,0.342267,0.0491107,0.474233,0.101488,0.0023671,0.0616852,4.65E-07,0.0363641,4.26E-07,3.37E-07,0.000915232,0.000595378,1.65E-05,0.007296,0.209032,0.000802328,0.000732558,0.0431249,0.173771,0.001372,0.0449571,8.07E-06,0.0273347,4.83E-06,2.82E-05,0.0168611,0.00522967,0.0138168,0.000168444,0.0114905,0.627843,0.00101142,0.474854,0.00105978,0.00183151,0.0161134,0.468753,0.00851653,0.321986,0.000344411,0.025482,2.30E-16,0.000733723,0.0173111,0.00999713)
# clustering_robust
pvalues <- c(0.999364,0.912132,0.931627,0.995808,0.984568,0.845777,0.67038,0.997328,0.996639,0.678499,0.988343,0.970408,0.955825,0.352309,0.890753,0.487575,0.762129,0.632888,0.996799,0.740767,0.593184,0.832051,0.998285,0.986947,0.948112,0.841818,0.999971,0.999916,0.808396,0.971672,0.574411,0.928604,0.994109,0.997838,0.940109,0.985344,0.993948,0.981435,0.999077,0.718093,0.994639,0.9067,0.981014,0.784328,0.811375,0.995063,0.977907,0.623018,0.999658,0.578586,0.980847,0.900682,0.00379448,0.517784,0.853242,0.99529)

p.adjust(pvalues, method = "fdr")


# cd /xdisk/mcnew/dannyjackson/sulidae/analyses/dsuite/all
~/programs/Dsuite/Build/Dsuite Fbranch all.nwk SETS_tree.txt -p 0.001 > all_Fbranch.txt
python3 ~/programs/Dsuite/utils/dtools.py all_Fbranch.txt all.nwk --tree-label-size 5 --ladderize --use_distances

# p-value
p_values <- c(2.30E-16,2.30E-16,5.78E-07,1.11E-09,2.30E-16,0.0190071,0.964665,2.75E-14,0.45049,2.86E-09,0.000185578,1.06E-08,0.0861671,2.30E-16,2.08E-13,1.62E-05,2.30E-16,2.30E-16,0.914922,0.011247,0.454719,6.52E-15,2.30E-16,2.30E-16,2.30E-16,2.30E-16,6.73E-08,6.93E-15,0.0402984,2.30E-16,0.540441,2.30E-16,1.08E-10,0.129367,2.48E-09,3.99E-08,0.00171307,2.09E-09,4.67E-10,5.03E-14,0.0587784,3.21E-05,2.83E-08,0.0462343,4.89E-15,0.134311,0.00562289,5.91E-06,2.30E-16,2.30E-16,2.30E-16,2.30E-16,0.249513,5.69E-07,2.50E-08,2.30E-16)
# cs_p-value
p_values <- c(2.30E-16,7.03E-06,0.0168534,0.181557,0.000670175,0.0267089,0.00336978,0.128823,0.0174879,0.342267,0.0491107,0.474233,0.101488,0.000915232,0.000595378,1.65E-05,0.007296,0.209032,0.000802328,0.000732558,0.0431249,0.173771,0.0168611,0.00522967,0.0138168,0.000168444,0.0114905,0.627843,0.00101142,0.474854,0.00105978,0.00183151,0.0161134,0.468753,0.00851653,0.321986,0.000344411,0.025482,0.00308481,0.0114666,0.0044783,0.0023671,0.0616852,4.65E-07,0.0363641,4.26E-07,3.37E-07,0.001372,0.0449571,8.07E-06,0.0273347,4.83E-06,2.82E-05,0.000733723,0.0173111,0.00999713)
# cr_p-value
p_values <- c(0.00379448,0.845777,0.999364,0.912132,0.67038,0.997328,0.996639,0.678499,0.988343,0.970408,0.955825,0.352309,0.890753,0.832051,0.998285,0.986947,0.948112,0.841818,0.999971,0.999916,0.808396,0.971672,0.993948,0.981435,0.999077,0.718093,0.994639,0.9067,0.981014,0.784328,0.811375,0.995063,0.977907,0.623018,0.999658,0.578586,0.980847,0.900682,0.931627,0.995808,0.984568,0.487575,0.762129,0.632888,0.996799,0.740767,0.593184,0.574411,0.928604,0.994109,0.997838,0.940109,0.985344,0.517784,0.853242,0.99529)

p.adjust(p_values, method = "fdr")

0.2124909
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710
0.9999710

echo -e 'MABO_AtlCar\tMABO_IndoPacific\tNABO' > test_trios.txt
echo -e 'BFBO_GofCA\tBFBO_southern\tPEBO' >> test_trios.txt

# Dinvestigate MABO NABO and BFBO PEBO
~/programs/Dsuite/Build/Dsuite Dinvestigate -w 50,25 $VCF SETS.txt test_trios.txt

